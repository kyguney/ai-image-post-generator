!function(){"use strict";var e=window.wp.blocks,t=window.wp.element,a=window.React,l=window.lodash,n=window.wp.i18n,c=window.wp.blockEditor,s=window.wp.notices,o=window.wp.components,r=window.wp.blob,i=window.wp.data,m=window.wp.primitives;var g=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{d:"M18.5 15v3.5H13V6.7l4.5 4.1 1-1.1-6.2-5.8-5.8 5.8 1 1.1 4-4v11.7h-6V15H4v5h16v-5z"}));var u=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},(0,a.createElement)(m.Path,{d:"M10 1c-5 0-9 4-9 9s4 9 9 9 9-4 9-9-4-9-9-9zm0 16c-3.9 0-7-3.1-7-7s3.1-7 7-7 7 3.1 7 7-3.1 7-7 7zm1-11H9v3H6v2h3v3h2v-3h3V9h-3V6zM10 1c-5 0-9 4-9 9s4 9 9 9 9-4 9-9-4-9-9-9zm0 16c-3.9 0-7-3.1-7-7s3.1-7 7-7 7 3.1 7 7-3.1 7-7 7zm1-11H9v3H6v2h3v3h2v-3h3V9h-3V6z"}));var p=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{d:"M16 10h4c.6 0 1-.4 1-1V5c0-.6-.4-1-1-1h-4c-.6 0-1 .4-1 1v4c0 .6.4 1 1 1zm-8 4H4c-.6 0-1 .4-1 1v4c0 .6.4 1 1 1h4c.6 0 1-.4 1-1v-4c0-.6-.4-1-1-1zm10-2.6L14.5 15l1.1 1.1 1.7-1.7c-.1 1.1-.3 2.3-.9 2.9-.3.3-.7.5-1.3.5h-4.5v1.5H15c.9 0 1.7-.3 2.3-.9 1-1 1.3-2.7 1.4-4l1.8 1.8 1.1-1.1-3.6-3.7zM6.8 9.7c.1-1.1.3-2.3.9-2.9.4-.4.8-.6 1.3-.6h4.5V4.8H9c-.9 0-1.7.3-2.3.9-1 1-1.3 2.7-1.4 4L3.5 8l-1 1L6 12.6 9.5 9l-1-1-1.7 1.7z"}));var w=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{d:"M20 11.2H6.8l3.7-3.7-1-1L3.9 12l5.6 5.5 1-1-3.7-3.7H20z"}));var d=(0,a.createElement)(m.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(m.Path,{d:"m14.5 6.5-1 1 3.7 3.7H4v1.6h13.2l-3.7 3.7 1 1 5.6-5.5z"}));var h=({medias:e,onChangeImage:l})=>{const[n,c]=(0,a.useState)(0),s=e&&e.length>0,r=e&&e.length>1,i=s?e.length:0;(0,a.useEffect)((()=>{l(e[n])}),[n,e,l]);return(0,t.createElement)("div",{className:"aipg-slider-container"},s&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{className:"aipg-slider-content",style:{transform:`translateX(-${100*n}%)`}},e.map(((e,a)=>(0,t.createElement)("div",{key:`image-${a+1}`,className:"aipg-slide"},(0,t.createElement)("img",{src:e,alt:""}))))),r&&(0,t.createElement)("div",{className:"aipg-slider-buttons"},(0,t.createElement)(o.Button,{className:"aipg-slider-button",onClick:()=>{c((e=>0===e?i-1:e-1))}},(0,t.createElement)(o.Icon,{icon:w})),(0,t.createElement)(o.Button,{className:"aipg-slider-button",onClick:()=>{c((e=>(e+1)%i))}},(0,t.createElement)(o.Icon,{icon:d})))))};var v=e=>{const{attributes:m,setAttributes:w}=e,{numberOfImage:d,keywords:v,unsplashImages:b,blockImage:E,autoSearch:k}=m,{id:y,url:f}=E,_=["image"],{mediaUpload:I}=(0,i.useSelect)((e=>{const{getSettings:t}=e(c.store);return(0,l.pick)(t(),["mediaUpload"])})),{createErrorNotice:S,createSuccessNotice:V}=(0,i.useDispatch)(s.store),[x,z]=(0,a.useState)(!1),[B,C]=(0,a.useState)(!1),[H,N]=(0,a.useState)(!1),[T,P]=(0,a.useState)(!1),L=0!==y&&""!==f,M=0===y&&""!==f,O=b&&0!==Object.keys(b).length&&b.constructor===Object,j=L||M||O,U=(0,c.useBlockProps)({className:"unsplash-image-block"}),F=async(e,t)=>{const a={},l=[],n=Array(t).fill("a");z(!0),await e.reduce((async(e,t)=>{await e;const c=[];await n.reduce((async e=>{await e;const a=await(async e=>{try{const t=`https://source.unsplash.com/1024x1024/?${e}`,a=await fetch(t),{url:l}=a;return l}catch(e){throw console.error(e),e}})(t);c.push(a),l.push(a)}),Promise.resolve());const s={[t.toLowerCase().replace(/\s/g,"_")]:c};Object.assign(a,s)}),Promise.resolve()),z(!1),N(l),w({unsplashImages:a})};return(0,a.useEffect)((()=>{""!==f&&C(f)}),[f]),(0,a.useEffect)((()=>{b&&N((e=>{let t=[];return Object.keys(e).forEach((a=>{t=[...t,...e[a]]})),t})(b))}),[b]),(0,a.useEffect)((()=>{k&&F(v,d)}),[k]),(0,t.createElement)("div",U,j?(0,t.createElement)(t.Fragment,null,(0,t.createElement)(c.BlockControls,{group:"block"},B&&M&&(0,t.createElement)(o.ToolbarButton,{showTooltip:!0,onClick:async()=>{const e=await(async e=>{const t=await fetch(e);return await t.blob()})(B);I({filesList:[e],onFileChange([e]){w({blockImage:{id:e.id,url:e.url}}),(0,r.isBlobURL)(e.url)||V((0,n.__)("Image uploaded."),{type:"snackbar"})},allowedTypes:_,onError(e){S(e,{type:"snackbar"})}})},icon:g,label:(0,n.__)("Upload external image")}),!B&&!M&&!L&&(0,t.createElement)(o.ToolbarButton,{showTooltip:!0,icon:"update-alt",label:(0,n.__)("Research images","aipg-plugin"),onClick:()=>w({unsplashImages:{}})}),!B&&(0,t.createElement)(o.ToolbarButton,{showTooltip:!0,icon:u,label:(0,n.__)("Select Image","aipg-plugin"),onClick:()=>{C(T),w({blockImage:{id:0,url:T}})}}),B&&(0,t.createElement)(o.ToolbarButton,{showTooltip:!0,icon:p,label:(0,n.__)("Replace Image","aipg-plugin"),onClick:()=>{C(""),P(""),w({blockImage:{id:0,url:""}})}})),B?(0,t.createElement)("img",{src:B,alt:""}):(0,t.createElement)(h,{medias:H,onChangeImage:P})):(0,t.createElement)(o.Placeholder,{icon:(0,t.createElement)(c.BlockIcon,{icon:"format-image"}),label:(0,n.__)("Unsplash Image","aipg-plugin"),instructions:(0,n.__)("Quickly add image keywords to add images in your site.","aipg-plugin")},x?(0,t.createElement)(o.Spinner,null):(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{className:"unsplash-image-block__keywords"},(0,t.createElement)(o.FormTokenField,{__experimentalValidateInput:e=>/^[a-zA-Z][a-zA-Z0-9 ]+$/.test(e),label:"Keywords",value:v,onChange:e=>w({keywords:e}),maxLength:5})),(0,t.createElement)("div",{className:"unsplash-image-block__image-number"},(0,t.createElement)(o.RangeControl,{value:d,label:(0,n.__)("Number of images per searched keywords","aipg-plugin"),onChange:e=>w({numberOfImage:e}),min:1,max:5})),v&&v.length>0?(0,t.createElement)("div",{className:"unsplash-image-block__search"},(0,t.createElement)(o.Button,{variant:"primary",onClick:()=>F(v,d)},(0,n.__)("Search images","aipg-plugin"))):null)))},b=JSON.parse('{"title":"Unsplash Image","apiVersion":2,"description":"Upload image from unsplash","textdomain":"aipg-plugin","name":"aipg-plugin/unsplash-image","icon":"image","category":"aipg-plugin","attributes":{"numberOfImage":{"type":"number","default":1},"keywords":{"type":"array","default":[]},"unsplashImages":{"type":"object","default":{}},"blockImage":{"type":"object","default":{"id":0,"url":""}},"autoSearch":{"type":"boolean","default":false}},"editorScript":"file:./index.js"}');const E=(0,t.createElement)(o.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,t.createElement)(o.Path,{d:"M20.2 8v11c0 .7-.6 1.2-1.2 1.2H6v1.5h13c1.5 0 2.7-1.2 2.7-2.8V8h-1.5zM18 16.4V4.6c0-.9-.7-1.6-1.6-1.6H4.6C3.7 3 3 3.7 3 4.6v11.8c0 .9.7 1.6 1.6 1.6h11.8c.9 0 1.6-.7 1.6-1.6zM4.5 4.6c0-.1.1-.1.1-.1h11.8c.1 0 .1.1.1.1V12l-2.3-1.7c-.3-.2-.6-.2-.9 0l-2.9 2.1L8 11.3c-.2-.1-.5-.1-.7 0l-2.9 1.5V4.6zm0 11.8v-1.8l3.2-1.7 2.4 1.2c.2.1.5.1.8-.1l2.8-2 2.8 2v2.5c0 .1-.1.1-.1.1H4.6c0-.1-.1-.2-.1-.2z"}));(0,e.registerBlockType)(b,{icon:E,edit:v,save:()=>null})}();